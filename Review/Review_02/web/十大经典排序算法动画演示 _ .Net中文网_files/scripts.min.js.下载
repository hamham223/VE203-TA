function notice(s,e,n,a){var t=a||jQuery(".mce-tinymce");clearTimeout(timer),jQuery("#notice").remove(),t.append('<div id="notice"><div class="notice-bg"></div><div class="notice-wrap"><div class="notice-inner notice-'+s+'">'+e+"</div></div></div>"),n&&(timer=setTimeout(function(){jQuery("#notice").remove()},n))}function comments_list(s,e){var n="";if(s&&s.length)for(var a=0;a<s.length;a++)n+='<li class="as-comments-item" data-id="'+s[a].ID+'">            <div class="as-comment-name">'+s[a].user+" <span>"+s[a].date+"</span>"+("1"==e?'<span><a class="j-del-comment" href="javascript:;">'+QAPress_js.lang.delete+"</a></span>":"")+'</div>            <div class="as-comment-content">'+s[a].content+"</div>            </li>";else n+='<li class="as-comments-none">'+QAPress_js.lang.nocomment2+"</li>";return n}var timer=null;jQuery(document).ready(function(s){var e=0,n=s(".q-single");n.length&&s.ajax({url:QAPress_js.ajaxurl,data:{action:"QAPress_views",id:n.data("id")},type:"POST",success:function(s){}}),s("#answer").on("click",".j-reply",function(){var e=s(this).closest(".as-item");if(e.find(".as-comments-box").length)s(".as-comments-box").remove(),s(".as-comments").remove();else{var n='<div class="as-comments-box">        <form method="post" class="as-comments-form clearfix">        <input type="hidden" name="id" value="'+e.data("aid")+'" >    <input class="as-comments-input form-control" name="comment" type="text" placeholder="'+QAPress_js.lang.addcomment+'" autocomplete="off">    <input class="as-comments-submit" type="submit" value="'+QAPress_js.lang.submit+'">    </form></div>';s(".as-comments-box").remove(),s(".as-comments").remove(),e.find(".as-main").append(n),e.find(".as-comments-input").focus()}}),s("#answer").on("click",".j-reply-list",function(){var e=s(this).closest(".as-item"),n=e.find(".as-comments").length;e.find(".as-comments-box").remove(),e.find(".as-comments").remove(),n||(e.find(".as-main").append('<div class="as-comments"><ul class="as-comments-list"><li class="as-comments-none"><img class="notice-loading" src="'+QAPress_js.ajaxloading+'"> '+QAPress_js.lang.loading+"</li></ul></div>"),s.ajax({url:QAPress_js.ajaxurl,data:{action:"QAPress_comments",aid:e.data("aid")},type:"POST",dataType:"json",success:function(s){if(0==s.result){var n=comments_list(s.comments,s.delete);e.find(".as-main .as-comments-list").html(n)}else e.find(".as-main .as-comments-list").html('<li class="as-comments-none">'+QAPress_js.lang.error1+"</li>"),notice(0,QAPress_js.lang.error1,1200,e)},error:function(){e.find(".as-main .as-comments-list").html('<li class="as-comments-none">'+QAPress_js.lang.error2+"</li>"),notice(0,QAPress_js.lang.error2,1200,e)}}))}).on("click",".j-answer-del",function(){if(confirm(QAPress_js.lang.confirm)){$el=s(this).closest(".as-item"),notice(1,'<img class="notice-loading" src="'+QAPress_js.ajaxloading+'"> '+QAPress_js.lang.deleting,0,$el);var e=$el.data("aid");s.ajax({url:QAPress_js.ajaxurl,data:{action:"QAPress_delete_answer",id:e},type:"POST",dataType:"json",success:function(e){clearTimeout(timer),s("#notice").remove(),0==e.result?(notice(1,QAPress_js.lang.success,1500,$el),setTimeout(function(){$el.fadeOut("fast",function(){var s=$el.closest(".as-list");$el.remove(),0==s.find(".as-item").length&&s.append('<li class="as-item-none" style="text-align: center;color: #999;padding-top: 10px;">'+QAPress_js.lang.nocomment+"</li>")})},1400)):2==e.result?notice(0,QAPress_js.lang.denied,1200,$el):notice(0,QAPress_js.lang.error3,1200,$el)},error:function(e){clearTimeout(timer),s("#notice").remove(),notice(0,QAPress_js.lang.error3,1200,$el)}})}}).on("click",".j-del-comment",function(){if(confirm(QAPress_js.lang.confirm2)){$el=s(this).closest(".as-comments-item"),notice(1,'<img class="notice-loading" src="'+QAPress_js.ajaxloading+'"> '+QAPress_js.lang.deleting,0,$el);var e=$el.data("id");s.ajax({url:QAPress_js.ajaxurl,data:{action:"QAPress_delete_comment",id:e},type:"POST",dataType:"json",success:function(e){clearTimeout(timer),s("#notice").remove(),0==e.result?(notice(1,QAPress_js.lang.success,1500,$el),setTimeout(function(){$el.fadeOut("fast",function(){var s=$el.closest(".as-comments-list");$el.remove(),0==s.find(".as-comments-item").length&&s.append('<li class="as-comments-none">'+QAPress_js.lang.nocomment2+"</li>")})},1400)):2==e.result?notice(0,QAPress_js.lang.denied,1200,$el):notice(0,QAPress_js.lang.error3,1200,$el)},error:function(e){clearTimeout(timer),s("#notice").remove(),notice(0,QAPress_js.lang.error3,1200,$el)}})}}),s("#as-form").submit(function(){if(e)return!1;e=1,tinyMCE.triggerSave();var n=s("#editor-answer").val();return s.trim(n)?(notice(1,'<img class="notice-loading" src="'+QAPress_js.ajaxloading+'"> '+QAPress_js.lang.submitting,0),s.ajax({url:QAPress_js.ajaxurl,data:s(this).serialize()+"&action=QAPress_add_answer",type:"POST",dataType:"json",success:function(n){if(e=0,0==n.result){notice(1,QAPress_js.lang.success2,1200);var a='<li id="as-'+n.answer.ID+'" class="as-item" data-aid="'+n.answer.ID+'" style="display: none;"><div class="as-head">                            <div class="as-avatar">'+n.user.avatar+'</div>                            <div class="as-user">'+n.user.nickname+'</div>                            </div>                        <div class="as-main">                        <div class="as-content entry-content">'+n.answer.content+'</div>                        <div class="as-action">                        <span class="as-time">'+n.answer.date+'</span>                        <span class="as-reply-count"><a class="j-reply-list" href="javascript:;">'+QAPress_js.lang.ncomment+"</a></span>                        </div>                        </div>                        </li>";s(".as-list").append(a),s("#as-"+n.answer.ID).fadeIn(),s(".as-item-none").remove(),tinyMCE.activeEditor.setContent("")}else 101==n.result?notice(0,QAPress_js.lang.empty,1200):2==n.result?notice(0,QAPress_js.lang.login,2e3):notice(0,QAPress_js.lang.error4,1200)},error:function(s){e=0,notice(0,QAPress_js.lang.error4,1200)}}),!1):(notice(0,QAPress_js.lang.empty,1e3),e=0,!1)}),s("#answer").on("submit",".as-comments-form",function(){if(e)return!1;e=1;var n=s(this).find(".as-comments-input").val(),a=s(this).closest(".as-item");return s.trim(n)?(notice(1,'<img class="notice-loading" src="'+QAPress_js.ajaxloading+'"> '+QAPress_js.lang.submitting,0,a),s.ajax({url:QAPress_js.ajaxurl,data:s(this).serialize()+"&action=QAPress_add_comment",type:"POST",dataType:"json",success:function(s){e=0,0==s.result?(notice(1,QAPress_js.lang.success2,2e3,a),a.find(".as-comments-input").val("")):101==s.result?notice(0,QAPress_js.lang.empty,1200,a):2==s.result?notice(0,QAPress_js.lang.login,2e3,a):notice(0,QAPress_js.lang.error4,1200,a)},error:function(s){e=0,notice(0,QAPress_js.lang.error4,1200,a)}}),!1):(notice(0,QAPress_js.lang.empty,1200,a),e=0,!1)}),s("#question-form").submit(function(){if(e)return!1;e=1,tinyMCE.triggerSave();var n=s("input[name=title]").val(),a=s("select[name=category]").val(),t=s("#editor-question").val();return n?a?s.trim(t)?(notice(1,'<img class="notice-loading" src="'+QAPress_js.ajaxloading+'"> '+QAPress_js.lang.submitting,0),s.ajax({url:QAPress_js.ajaxurl,data:s(this).serialize()+"&action=QAPress_add_question",type:"POST",dataType:"json",success:function(n){e=0,0==n.result?(console.log(n),s("input[name=id]").val()?notice(1,void 0===n.msg?QAPress_js.lang.success3:n.msg,1500):(e=1,notice(1,void 0===n.msg?QAPress_js.lang.success4:n.msg,1200)),void 0!==n.location&&setTimeout(function(){window.location.href=n.location,e=0},1200)):101==n.result?notice(0,QAPress_js.lang.need_all,1200):102==n.result?notice(0,QAPress_js.lang.length,1200):notice(0,QAPress_js.lang.error4,1200)},error:function(s){e=0,notice(0,QAPress_js.lang.error4,1200)}}),!1):(notice(0,QAPress_js.lang.need_content,1200),e=0,!1):(notice(0,QAPress_js.lang.need_cat,1200),e=0,!1):(notice(0,QAPress_js.lang.need_title,1200),e=0,!1)}),s("#answer").on("click",".q-load-more",function(){var e=s(this);if(!e.hasClass("disabled")){e.addClass("disabled").text(QAPress_js.lang.loading);var n=s(".q-single").data("id"),a=e.data("page");a=a||2,s.ajax({url:QAPress_js.ajaxurl,data:{action:"QAPress_answers_pagination",question:n,page:a},type:"POST",dataType:"json",success:function(n){if(0==n.result){var t="";if(n.answers.length){for(var i=0;i<n.answers.length;i++)t+=n.answers[i];s(".as-list").append(t)}else s(".q-load-more").css("visibility","hidden"),notice(1,QAPress_js.lang.load_done,1500,s(".as-list"))}else notice(0,QAPress_js.lang.load_fail,1500,s(".as-list"));e.removeClass("disabled").text(QAPress_js.lang.load_more),e.data("page",a+1)},error:function(n){e.removeClass("disabled").text(QAPress_js.lang.load_more),notice(0,QAPress_js.lang.load_fail,1500,s(".as-list"))}})}}),s(".topic-header").on("click",".j-del",function(){if(confirm(QAPress_js.lang.confirm3)){notice(1,'<img class="notice-loading" src="'+QAPress_js.ajaxloading+'"> '+QAPress_js.lang.deleting,0,s(".q-entry"));var e=s(".q-single").data("id");s.ajax({url:QAPress_js.ajaxurl,data:{action:"QAPress_delete_question",id:e},type:"POST",dataType:"json",success:function(e){clearTimeout(timer),s("#notice").remove(),0==e.result?notice(1,QAPress_js.lang.success,1500,s(".q-entry")):2==e.result?notice(0,QAPress_js.lang.denied,1200,s(".q-entry")):notice(0,QAPress_js.lang.error3,1200,s(".q-entry"))},error:function(e){clearTimeout(timer),s("#notice").remove(),notice(0,QAPress_js.lang.error3,1200,s(".q-entry"))}})}}).on("click",".j-approve",function(){if(confirm(QAPress_js.lang.approve)){notice(1,'<img class="notice-loading" src="'+QAPress_js.ajaxloading+'"> '+QAPress_js.lang.loading,0,s(".q-entry"));var e=s(".q-single").data("id");s.ajax({url:QAPress_js.ajaxurl,data:{action:"QAPress_approve_question",id:e},type:"POST",dataType:"json",success:function(e){clearTimeout(timer),s("#notice").remove(),0==e.result?(notice(1,QAPress_js.lang.success,1500,s(".q-entry")),s(".j-approve").remove()):2==e.result?notice(0,QAPress_js.lang.denied,1200,s(".q-entry")):notice(0,QAPress_js.lang.error2,1200,s(".q-entry"))},error:function(e){clearTimeout(timer),s("#notice").remove(),notice(0,QAPress_js.lang.error2,1200,s(".q-entry"))}})}}).on("click",".j-set-top",function(){notice(1,'<img class="notice-loading" src="'+QAPress_js.ajaxloading+'"> '+QAPress_js.lang.loading,0,s(".q-entry"));var e=s(".q-single").data("id");s.ajax({url:QAPress_js.ajaxurl,data:{action:"QAPress_set_top",id:e},type:"POST",dataType:"json",success:function(e){clearTimeout(timer),s("#notice").remove(),0==e.result?(notice(1,QAPress_js.lang.success,1500,s(".q-entry")),window.location.reload()):2==e.result?notice(0,QAPress_js.lang.denied,1200,s(".q-entry")):notice(0,QAPress_js.lang.error2,1200,s(".q-entry"))},error:function(e){clearTimeout(timer),s("#notice").remove(),notice(0,QAPress_js.lang.error2,1200,s(".q-entry"))}})}),s(".wpcom-profile").on("click",".j-user-questions,.j-user-answers",function(){var e=s(this);if(e.hasClass("loading")||e.hasClass("disabled"))return!1;var n=null,a=e.data("page");a=a?a+1:2;var t=s(".profile-tab").data("user");e.hasClass("j-user-questions")?n={action:"QAPress_user_questions",user:t||0,page:a}:e.hasClass("j-user-answers")&&(n={action:"QAPress_user_answers",user:t||0,page:a}),e.loading(1),s.ajax({type:"POST",url:_wpcom_js.ajaxurl,data:n,dataType:"html",success:function(n){if("0"==n)e.addClass("disabled").text(QAPress_js.lang.end);else{var t=s(n);e.parent().prev().append(t),t.find(".j-lazy").lazyload({threshold:-50,effect:"fadeIn"}),e.data("page",a),s(window).trigger("scroll")}e.loading(0)},error:function(){e.loading(0)}})})});